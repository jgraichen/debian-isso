/**
 * @license almond 0.2.9 Copyright (c) 2011-2014, The Dojo Foundation All Rights Reserved.
 * Available via the MIT or new BSD license.
 * see: http://github.com/jrburke/almond for details
 */

(function(){var e,t,n;(function(r){function v(e,t){return h.call(e,t)}function m(e,t){var n,r,i,s,o,u,a,f,c,h,p,v=t&&t.split("/"),m=l.map,g=m&&m["*"]||{};if(e&&e.charAt(0)===".")if(t){v=v.slice(0,v.length-1),e=e.split("/"),o=e.length-1,l.nodeIdCompat&&d.test(e[o])&&(e[o]=e[o].replace(d,"")),e=v.concat(e);for(c=0;c<e.length;c+=1){p=e[c];if(p===".")e.splice(c,1),c-=1;else if(p===".."){if(c===1&&(e[2]===".."||e[0]===".."))break;c>0&&(e.splice(c-1,2),c-=2)}}e=e.join("/")}else e.indexOf("./")===0&&(e=e.substring(2));if((v||g)&&m){n=e.split("/");for(c=n.length;c>0;c-=1){r=n.slice(0,c).join("/");if(v)for(h=v.length;h>0;h-=1){i=m[v.slice(0,h).join("/")];if(i){i=i[r];if(i){s=i,u=c;break}}}if(s)break;!a&&g&&g[r]&&(a=g[r],f=c)}!s&&a&&(s=a,u=f),s&&(n.splice(0,u,s),e=n.join("/"))}return e}function g(e,t){return function(){return s.apply(r,p.call(arguments,0).concat([e,t]))}}function y(e){return function(t){return m(t,e)}}function b(e){return function(t){a[e]=t}}function w(e){if(v(f,e)){var t=f[e];delete f[e],c[e]=!0,i.apply(r,t)}if(!v(a,e)&&!v(c,e))throw new Error("No "+e);return a[e]}function E(e){var t,n=e?e.indexOf("!"):-1;return n>-1&&(t=e.substring(0,n),e=e.substring(n+1,e.length)),[t,e]}function S(e){return function(){return l&&l.config&&l.config[e]||{}}}var i,s,o,u,a={},f={},l={},c={},h=Object.prototype.hasOwnProperty,p=[].slice,d=/\.js$/;o=function(e,t){var n,r=E(e),i=r[0];return e=r[1],i&&(i=m(i,t),n=w(i)),i?n&&n.normalize?e=n.normalize(e,y(t)):e=m(e,t):(e=m(e,t),r=E(e),i=r[0],e=r[1],i&&(n=w(i))),{f:i?i+"!"+e:e,n:e,pr:i,p:n}},u={require:function(e){return g(e)},exports:function(e){var t=a[e];return typeof t!="undefined"?t:a[e]={}},module:function(e){return{id:e,uri:"",exports:a[e],config:S(e)}}},i=function(e,t,n,i){var s,l,h,p,d,m=[],y=typeof n,E;i=i||e;if(y==="undefined"||y==="function"){t=!t.length&&n.length?["require","exports","module"]:t;for(d=0;d<t.length;d+=1){p=o(t[d],i),l=p.f;if(l==="require")m[d]=u.require(e);else if(l==="exports")m[d]=u.exports(e),E=!0;else if(l==="module")s=m[d]=u.module(e);else if(v(a,l)||v(f,l)||v(c,l))m[d]=w(l);else{if(!p.p)throw new Error(e+" missing "+l);p.p.load(p.n,g(i,!0),b(l),{}),m[d]=a[l]}}h=n?n.apply(a[e],m):undefined;if(e)if(s&&s.exports!==r&&s.exports!==a[e])a[e]=s.exports;else if(h!==r||!E)a[e]=h}else e&&(a[e]=n)},e=t=s=function(e,t,n,a,f){if(typeof e=="string")return u[e]?u[e](t):w(o(e,t).f);if(!e.splice){l=e,l.deps&&s(l.deps,l.callback);if(!t)return;t.splice?(e=t,t=n,n=null):e=r}return t=t||function(){},typeof n=="function"&&(n=a,a=f),a?i(r,e,t,n):setTimeout(function(){i(r,e,t,n)},4),s},s.config=function(e){return s(e)},e._defined=a,n=function(e,t,n){t.splice||(n=t,t=[]),!v(a,e)&&!v(f,e)&&(f[e]=[e,t,n])},n.amd={jQuery:!0}})(),n("components/almond/almond",function(){}),n("app/lib/ready",[],function(){var e=!1,t=function(t){e||(e=!0,t())},n=function(e){document.addEventListener("DOMContentLoaded",function(){t(e)}),(document.readyState==="interactive"||document.readyState==="complete")&&t(e)};return n}),n("app/lib/promise",[],function(){var e=function(e){console.log(e)},t=function(){this.success=[],this.errors=[]};t.prototype.then=function(t,n){this.success.push(t),n?this.errors.push(n):this.errors.push(e)};var n=function(){this.promise=new t};n.prototype={promise:t,resolve:function(e){this.promise.success.forEach(function(t){window.setTimeout(function(){t(e)},0)})},reject:function(e){this.promise.errors.forEach(function(t){window.setTimeout(function(){t(e)},0)})}};var r=function(e,n){return e instanceof t?e.then(n):n(e)};return{defer:function(){return new n},when:r}}),n("app/globals",[],function(){var e=function(){this.values=[]};return e.prototype.update=function(e){this.values.push((new Date).getTime()-e.getTime())},e.prototype.localTime=function(){return new Date((new Date).getTime()+this.values.reduce(function(e,t){return e+t})/this.values.length)},{offset:new e}}),n("app/api",["app/lib/promise","app/globals"],function(e,t){var n="Eech7co8Ohloopo9Ol6baimi",r=window.location.pathname,i,s,o=document.getElementsByTagName("script");for(var u=0;u<o.length;u++)if(o[u].hasAttribute("data-isso")){s=o[u].getAttribute("data-isso");break}if(!s){for(u=0;u<o.length;u++)if(o[u].getAttribute("async")||o[u].getAttribute("defer"))throw"Isso's automatic configuration detection failed, please refer to https://github.com/posativ/isso#client-configuration and add a custom `data-isso` attribute.";i=o[o.length-1],s=i.src.substring(0,i.src.length-"/js/embed.min.js".length)}s[s.length-1]==="/"&&(s=s.substring(0,s.length-1));var a=function(e,n,r,i,s){function u(){var e=o.getResponseHeader("Date");e!==null&&t.offset.update(new Date(e));var n=o.getResponseHeader("X-Set-Cookie");n&&n.match(/^isso-/)&&(document.cookie=n),o.status>=500?s(o.body):i({status:o.status,body:o.responseText})}var o=new XMLHttpRequest;try{o.open(e,n,!0),o.withCredentials=!0,o.setRequestHeader("Content-Type","application/json"),o.onreadystatechange=function(){o.readyState===4&&u()}}catch(a){(s||console.log)(a.message)}o.send(r)},f=function(e){var t="";for(var n in e)e.hasOwnProperty(n)&&e[n]!==null&&typeof e[n]!="undefined"&&(t+=n+"="+encodeURIComponent(e[n])+"&");return t.substring(0,t.length-1)},l=function(t,n){var i=e.defer();return a("POST",s+"/new?"+f({uri:t||r}),JSON.stringify(n),function(e){i.resolve(JSON.parse(e.body))}),i.promise},c=function(t,n){var r=e.defer();return a("PUT",s+"/id/"+t,JSON.stringify(n),function(e){e.status===403?r.reject("Not authorized to modify this comment!"):e.status===200?r.resolve(JSON.parse(e.body)):r.reject(e.body)}),r.promise},h=function(t){var n=e.defer();return a("DELETE",s+"/id/"+t,null,function(e){e.status===403?n.reject("Not authorized to remove this comment!"):e.status===200?n.resolve(JSON.parse(e.body)===null):n.reject(e.body)}),n.promise},p=function(t,n){var r=e.defer();return a("GET",s+"/id/"+t+"?"+f({plain:n}),null,function(e){r.resolve(JSON.parse(e.body))}),r.promise},d=function(t,n,i,o,u){typeof n=="undefined"&&(n="inf"),typeof i=="undefined"&&(i="inf"),typeof o=="undefined"&&(o=null);var l={uri:t||r,after:u,parent:o};n!=="inf"&&(l.limit=n),i!=="inf"&&(l.nested_limit=i);var c=e.defer();return a("GET",s+"/?"+f(l),null,function(e){e.status===200?c.resolve(JSON.parse(e.body)):e.status===404?c.resolve({total_replies:0}):c.reject(e.body)}),c.promise},v=function(t){var n=e.defer();return a("POST",s+"/count",JSON.stringify(t),function(e){e.status===200?n.resolve(JSON.parse(e.body)):n.reject(e.body)}),n.promise},m=function(t){var n=e.defer();return a("POST",s+"/id/"+t+"/like",null,function(e){n.resolve(JSON.parse(e.body))}),n.promise},g=function(t){var n=e.defer();return a("POST",s+"/id/"+t+"/dislike",null,function(e){n.resolve(JSON.parse(e.body))}),n.promise};return{endpoint:s,salt:n,create:l,modify:c,remove:h,view:p,fetch:d,count:v,like:m,dislike:g}}),n("app/dom",[],function(){window.Element.prototype.replace=function(t){var n=e.htmlify(t);return this.parentNode.replaceChild(n,this),n},window.Element.prototype.prepend=function(t){var n=e.htmlify(t);return this.insertBefore(n,this.firstChild),n},window.Element.prototype.append=function(t){var n=e.htmlify(t);return this.appendChild(n),n},window.Element.prototype.insertAfter=function(t){var n=e.htmlify(t);return this.parentNode.insertBefore(n,this.nextSibling),n},window.Element.prototype.on=function(e,t,n){this.addEventListener(e,function(e){t(e),(n===undefined||n)&&e.preventDefault()})},window.Element.prototype.toggle=function(e,t,n){function r(e,t,n){this.state=!1,this.el=e,this.a=t,this.b=n}r.prototype.next=function(){this.state?(this.state=!1,this.b(this)):(this.state=!0,this.a(this))},r.prototype.wait=function(){this.state=!this.state};var i=new r(this,t,n);this.on(e,function(){i.next()})},window.Element.prototype.detach=function(){return this.parentNode.removeChild(this),this},window.Element.prototype.remove=function(){this.parentNode.removeChild(this)},window.Element.prototype.show=function(){this.style.display="block"},window.Element.prototype.hide=function(){this.style.display="none"};var e=function(e,t,n){typeof n=="undefined"&&(n=!0),t||(t=window.document);var r=t.querySelectorAll(e);return r.length===0?null:r.length===1&&n?r[0]:r};return e.htmlify=function(t){if(t instanceof window.Element)return t;var n=e.new("div");return n.innerHTML=t,n.firstChild},e.new=function(e,t){var n=document.createElement(e.split(".")[0]);return e.split(".").slice(1).forEach(function(e){n.classList.add(e)}),["A","LINK"].indexOf(n.nodeName)>-1&&(n.href="#"),["TEXTAREA","INPUT"].indexOf(n.nodeName)>-1?n.value=t||"":n.textContent=t||"",n},e.each=function(e,t){Array.prototype.forEach.call(document.getElementsByTagName(e),t)},e}),n("app/config",[],function(){var e={css:!0,lang:(navigator.language||navigator.userLanguage).split("-")[0],"reply-to-self":!1,"max-comments-top":"inf","max-comments-nested":5,"reveal-on-click":5,avatar:!0,"avatar-bg":"#f0f0f0","avatar-fg":["#9abf88","#5698c4","#e279a3","#9163b6","#be5168","#f19670","#e4bf80","#447c69"].join(" "),vote:!0},t=document.getElementsByTagName("script");for(var n=0;n<t.length;n++)for(var r=0;r<t[n].attributes.length;r++){var i=t[n].attributes[r];if(/^data-isso-/.test(i.name))try{e[i.name.substring(10)]=JSON.parse(i.value)}catch(s){e[i.name.substring(10)]=i.value}}return e["avatar-fg"]=e["avatar-fg"].split(" "),e}),n("app/i18n/de",{"postbox-text":"Kommentar hier eintippen (mindestens 3 Zeichen)","postbox-author":"Name (optional)","postbox-email":"Email (optional)","postbox-website":"Website (optional)","postbox-submit":"Abschicken","num-comments":"1 Kommentar\n{{ n }} Kommentare","no-comments":"Keine Kommentare bis jetzt","comment-reply":"Antworten","comment-edit":"Bearbeiten","comment-save":"Speichern","comment-delete":"Löschen","comment-confirm":"Bestätigen","comment-close":"Schließen","comment-cancel":"Abbrechen","comment-deleted":"Kommentar gelöscht.","comment-queued":"Kommentar muss noch freigeschaltet werden.","comment-anonymous":"Anonym","comment-hidden":"{{ n }} versteckt","date-now":"eben jetzt","date-minute":"vor einer Minute\nvor {{ n }} Minuten","date-hour":"vor einer Stunde\nvor {{ n }} Stunden","date-day":"Gestern\nvor {{ n }} Tagen","date-week":"letzte Woche\nvor {{ n }} Wochen","date-month":"letzten Monat\nvor {{ n }} Monaten","date-year":"letztes Jahr\nvor {{ n }} Jahren"}),n("app/i18n/en",{"postbox-text":"Type Comment Here (at least 3 chars)","postbox-author":"Name (optional)","postbox-email":"E-mail (optional)","postbox-website":"Website (optional)","postbox-submit":"Submit","num-comments":"One Comment\n{{ n }} Comments","no-comments":"No Comments Yet","comment-reply":"Reply","comment-edit":"Edit","comment-save":"Save","comment-delete":"Delete","comment-confirm":"Confirm","comment-close":"Close","comment-cancel":"Cancel","comment-deleted":"Comment deleted.","comment-queued":"Comment in queue for moderation.","comment-anonymous":"Anonymous","comment-hidden":"{{ n }} Hidden","date-now":"right now","date-minute":"a minute ago\n{{ n }} minutes ago","date-hour":"an hour ago\n{{ n }} hours ago","date-day":"Yesterday\n{{ n }} days ago","date-week":"last week\n{{ n }} weeks ago","date-month":"last month\n{{ n }} months ago","date-year":"last year\n{{ n }} years ago"}),n("app/i18n/fr",{"postbox-text":"Insérez votre commentaire ici (au moins 3 lettres)","postbox-author":"Nom (optionnel)","postbox-email":"Courriel (optionnel)","postbox-website":"Site web (optionnel)","postbox-submit":"Soumettre","num-comments":"{{ n }} commentaire\n{{ n }} commentaires","no-comments":"Aucun commentaire pour l'instant","comment-reply":"Répondre","comment-edit":"Éditer","comment-save":"Enregistrer","comment-delete":"Supprimer","comment-confirm":"Confirmer","comment-close":"Fermer","comment-cancel":"Annuler","comment-deleted":"Commentaire supprimé.","comment-queued":"Commentaire en attente de modération.","comment-anonymous":"Anonyme","comment-hidden":"1 caché\n{{ n }} cachés","date-now":"À l'instant","date-minute":"Il y a une minute\nIl y a {{ n }} minutes","date-hour":"Il y a une heure\nIl y a {{ n }} heures ","date-day":"Hier\nIl y a {{ n }} jours","date-week":"Il y a une semaine\nIl y a {{ n }} semaines","date-month":"Il y a un mois\nIl y a {{ n }} mois","date-year":"Il y a un an\nIl y a {{ n }} ans"}),n("app/i18n/ru",{"postbox-text":"Комментировать здесь  (минимум 3 символа)","postbox-author":"Имя (необязательно)","postbox-email":"Email (необязательно)","postbox-submit":"Отправить","num-comments":"1 Комментарий\n{{ n }} Комментарии","no-comments":"Нет Комментарев","comment-reply":"Ответить","comment-edit":"Правка","comment-save":"Сохранить","comment-delete":"Удалить","comment-confirm":"Подтвердить","comment-close":"Закрыть","comment-cancel":"Отменить","comment-deleted":"Удалить комментарий","comment-queued":"Комментарий должен быть разблокирован","comment-anonymous":"Анонимный","date-now":"Сейчас","date-minute":"Минут назад\n{{ n }} минут","date-hour":"Час назад\n{{ n }} часов","date-day":"Вчера\n{{ n }} дней","date-week":"на прошлой недели\n{{ n }} недель","date-month":"в прошоим месяце\n{{ n }} месяцов","date-year":"в прошлом году\n{{ n }} года\n{{ n }} лет"}),n("app/i18n/it",{"postbox-text":"Scrivi un commento qui (minimo 3 caratteri)","postbox-author":"Nome (opzionale)","postbox-email":"E-mail (opzionale)","postbox-website":"Sito web (opzionale)","postbox-submit":"Invia","num-comments":"Un Commento\n{{ n }} Commenti","no-comments":"Ancora Nessun Commento","comment-reply":"Rispondi","comment-edit":"Modifica","comment-save":"Salva","comment-delete":"Elimina","comment-confirm":"Conferma","comment-close":"Chiudi","comment-cancel":"Cancella","comment-deleted":"Commento eliminato.","comment-queued":"Commento in coda per moderazione.","comment-anonymous":"Anonimo","comment-hidden":"{{ n }} Nascosto","date-now":"poco fa","date-minute":"un minuto fa\n{{ n }} minuti fa","date-hour":"un ora fa\n{{ n }} ore fa","date-day":"Ieri\n{{ n }} giorni fa","date-week":"questa settimana\n{{ n }} settimane fa","date-month":"questo mese\n{{ n }} mesi fa","date-year":"quest'anno\n{{ n }} anni fa"}),n("app/i18n/eo",{"postbox-text":"Tajpu komenton ĉi-tie (almenaŭ 3 signoj)","postbox-author":"Nomo (malnepra)","postbox-email":"Retadreso (malnepra)","postbox-website":"Retejo (malnepra)","postbox-submit":"Sendu","num-comments":"{{ n }} komento\n{{ n }} komentoj","no-comments":"Neniu komento ankoraŭ","comment-reply":"Respondu","comment-edit":"Redaktu","comment-save":"Savu","comment-delete":"Forviŝu","comment-confirm":"Konfirmu","comment-close":"Fermu","comment-cancel":"Malfaru","comment-deleted":"Komento forviŝita","comment-queued":"Komento en atendovico por kontrolo.","comment-anonymous":"Sennoma","comment-hidden":"{{ n }} kaŝitaj","date-now":"ĵus nun","date-minute":"antaŭ unu minuto\nantaŭ {{ n }} minutoj","date-hour":"antaŭ unu horo\nantaŭ {{ n }} horoj","date-day":"hieraŭ\nantaŭ {{ n }} tagoj","date-week":"lasta semajno\nantaŭ {{ n }} semajnoj","date-month":"lasta monato\nantaŭ {{ n }} monatoj","date-year":"lasta jaro\nantaŭ {{ n }} jaroj"}),n("app/i18n",["app/config","app/i18n/de","app/i18n/en","app/i18n/fr","app/i18n/ru","app/i18n/it","app/i18n/eo"],function(e,t,n,r,i,s,o){var u=function(e){switch(e){case"en":case"de":case"it":case"eo":return function(e,t){return e[t===1?0:1]};case"fr":return function(e,t){return e[t>1?1:0]};case"ru":return function(e,t){return t%10===1&&t%100!==11?e[0]:t%10>=2&&t%10<=4&&(t%100<10||t%100>=20)?e[1]:typeof e[2]!="undefined"?e[2]:e[1]};default:return null}},a=e.lang;u(a)||(a="en");var f={de:t,en:n,fr:r,ru:i,it:s,eo:o},l=u(a),c=function(e){return f[a][e]||n[e]||"???"},h=function(e,t){var n;return n=c(e),n.indexOf("\n")>-1&&(n=l(n.split("\n"),+t)),n?n.replace("{{ n }}",+t):n};return{lang:a,translate:c,pluralize:h}}),n("app/count",["app/api","app/dom","app/i18n"],function(e,t,n){return function(){var r={};t.each("a",function(e){if(!e.href.match(/#isso-thread$/))return;var t=e.getAttribute("data-isso-id")||e.href.match(/^(.+)#isso-thread$/)[1].replace(/^.*\/\/[^\/]+/,"");t in r?r[t].push(e):r[t]=[e]});var i=Object.keys(r);e.count(i).then(function(e){for(var t in r)if(r.hasOwnProperty(t)){var s=i.indexOf(t);for(var o=0;o<r[t].length;o++)r[t][o].textContent=n.pluralize("num-comments",e[s])}})}}),t(["app/lib/ready","app/count"],function(e,t){e(function(){t()})}),n("count",function(){})})();